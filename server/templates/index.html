{% extends 'base_admin.html' %}

{% block title %}Gösterge Paneli{% endblock %}

{% block content %}
    <div class="page-header">
        <h1 class="page-title">Gösterge Paneli</h1>
        <p class="page-description">Oyun yönetim sisteminize hoş geldiniz</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-content">
                <div class="stat-icon purple">
                    <i class="fas fa-gamepad"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-label">Toplam Oyun</div>
                    <div class="stat-value">{{ stats.game_count }}</div>
                </div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-content">
                <div class="stat-icon blue">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-label">Kayıtlı Kullanıcı</div>
                    <div class="stat-value">{{ stats.user_count }}</div>
                </div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-content">
                <div class="stat-icon green">
                    <i class="fas fa-folder"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-label">Kategori</div>
                    <div class="stat-value">{{ stats.category_count }}</div>
                </div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-content">
                <div class="stat-icon amber">
                    <i class="fas fa-eye"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-label">Toplam Oturum</div>
                    <div class="stat-value">{{ total_clicks or 0 }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Son Eklenen Oyunlar Bölümü -->
    <div class="section">
        <div class="section-header">
            <h2 class="section-title">Son Eklenen Oyunlar</h2>
            <a href="{{ url_for('list_games') }}" class="section-link">
                Tümünü Gör
                <i class="fas fa-chevron-right"></i>
            </a>
        </div>
        
        {% if recent_games %}
        <div class="games-grid">
            {% for game in recent_games %}
            <div class="game-card">
                <div class="game-card-actions">
                    {% if game.id %}
                    <a href="{{ url_for('edit_game', game_id=game.id) }}" class="game-card-action-btn edit" title="Düzenle">
                        <i class="fas fa-pencil-alt"></i>
                    </a>
                    <form action="{{ url_for('delete_game', game_id=game.id) }}" method="POST" style="display: inline;"
                          onsubmit="return confirm('{{ game.oyun_adi }} oyununu silmek istediğinize emin misiniz?');">
                        <button type="submit" class="game-card-action-btn delete" title="Sil">
                            <i class="fas fa-trash"></i>
                        </button>
                    </form>
                    {% endif %}
                </div>
                {% if game.cover_image %}
                    <img src="{{ url_for('static', filename='images/covers/' + game.cover_image) }}"
                         alt="{{ game.oyun_adi }}"
                         class="game-card-cover"
                         onerror="this.src='{{ url_for('static', filename='images/covers/default-cover.jpg') }}'">
                {% else %}
                    <img src="{{ url_for('static', filename='images/covers/default-cover.jpg') }}"
                         alt="{{ game.oyun_adi }}"
                         class="game-card-cover">
                {% endif %}
                <div class="game-card-content">
                    <div class="game-card-title">{{ game.oyun_adi }}</div>
                    <div class="game-card-category">
                        {% if game.category_names %}
                            {{ game.category_names.split(',')[0].strip() }}
                        {% else %}
                            Kategorisiz
                        {% endif %}
                    </div>
                    <div class="game-card-stats">
                        <span class="badge active">Aktif</span>
                        <span class="game-card-clicks">0 kez oynandı</span>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="card">
            <p style="text-align: center; padding: 2rem; color: var(--muted-foreground);">Henüz hiç oyun eklenmemiş.</p>
        </div>
        {% endif %}
    </div>

    <!-- En Çok Oynanan Oyunlar Bölümü -->
    <div class="section">
        <div class="section-header">
            <h2 class="section-title">En Çok Oynanan Oyunlar</h2>
            <a href="{{ url_for('list_games') }}" class="section-link">
                Tümünü Gör
                <i class="fas fa-chevron-right"></i>
            </a>
        </div>
        
        {% if most_played_games %}
        <div class="games-grid">
            {% for game in most_played_games %}
            <div class="game-card">
                <div class="game-card-actions">
                    {% if game.id %}
                    <a href="{{ url_for('edit_game', game_id=game.id) }}" class="game-card-action-btn edit" title="Düzenle">
                        <i class="fas fa-pencil-alt"></i>
                    </a>
                    <form action="{{ url_for('delete_game', game_id=game.id) }}" method="POST" style="display: inline;"
                          onsubmit="return confirm('{{ game.oyun_adi }} oyununu silmek istediğinize emin misiniz?');">
                        <button type="submit" class="game-card-action-btn delete" title="Sil">
                            <i class="fas fa-trash"></i>
                        </button>
                    </form>
                    {% endif %}
                </div>
                {% if game.cover_image %}
                    <img src="{{ url_for('static', filename='images/covers/' + game.cover_image) }}"
                         alt="{{ game.oyun_adi }}"
                         class="game-card-cover"
                         onerror="this.src='{{ url_for('static', filename='images/covers/default-cover.jpg') }}'">
                {% else %}
                    <img src="{{ url_for('static', filename='images/covers/default-cover.jpg') }}"
                         alt="{{ game.oyun_adi }}"
                         class="game-card-cover">
                {% endif %}
                <div class="game-card-content">
                    <div class="game-card-title">{{ game.oyun_adi }}</div>
                    <div class="game-card-category">
                        {% if game.category_names %}
                            {{ game.category_names.split(',')[0].strip() }}
                        {% else %}
                            Kategorisiz
                        {% endif %}
                    </div>
                    <div class="game-card-stats">
                        <span class="badge active">Aktif</span>
                        <span class="game-card-clicks">{{ game.play_count or 0 }} kez oynandı</span>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="card">
            <p style="text-align: center; padding: 2rem; color: var(--muted-foreground);">Henüz oyun oynama verisi yok.</p>
        </div>
        {% endif %}
    </div>

    <!-- Disk Kullanım Durumu Bölümü -->
    <div class="section">
        <div class="section-header">
            <h2 class="section-title">Disk Kullanımı</h2>
        </div>
        
        {% if drives %}
        <div class="disk-grid">
            {% for drive in drives %}
            <div class="disk-card">
                <div class="disk-header">
                    <div class="disk-icon {% if drive.usage_percent <= 60 %}disk-green{% elif drive.usage_percent <= 80 %}disk-amber{% else %}disk-red{% endif %}">
                        <i class="fas fa-hdd"></i>
                    </div>
                    <div class="disk-info">
                        <div class="disk-name">
                            {% if drive.custom_name %}
                                {{ drive.custom_name }}
                            {% else %}
                                {{ drive.volume_name }}
                            {% endif %}
                        </div>
                        <div class="disk-drive">{{ drive.device_id }}</div>
                    </div>
                </div>
                <div class="disk-stats">
                    <div class="disk-stat-row">
                        <span>Kapasite</span>
                        <span class="disk-stat-value">
                            {% if drive.size_gb != 'Bilinmiyor' %}{{ drive.size_gb }} GB{% else %}{{ drive.size_gb }}{% endif %}
                        </span>
                    </div>
                    <div class="disk-stat-row">
                        <span>Kullanılan</span>
                        <span class="disk-stat-value">
                            {% if drive.used_gb != 'Bilinmiyor' %}{{ drive.used_gb }} GB{% else %}{{ drive.used_gb }}{% endif %}
                        </span>
                    </div>
                    <div class="disk-stat-row">
                        <span>Boş Alan</span>
                        <span class="disk-stat-value">
                            {% if drive.free_space_gb != 'Bilinmiyor' %}{{ drive.free_space_gb }} GB{% else %}{{ drive.free_space_gb }}{% endif %}
                        </span>
                    </div>
                </div>
                {% if drive.size_gb != 'Bilinmiyor' and drive.usage_percent > 0 %}
                <div class="disk-progress-container">
                    <div class="disk-progress-bar {% if drive.usage_percent <= 60 %}disk-progress-green{% elif drive.usage_percent <= 80 %}disk-progress-amber{% else %}disk-progress-red{% endif %}" 
                         style="width: {{ drive.usage_percent }}%"></div>
                </div>
                <div class="disk-usage-text">{{ drive.usage_percent }}% Kullanımda</div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="card">
            <p style="text-align: center; padding: 2rem; color: var(--muted-foreground);">C: diski dışında hiçbir disk bulunamadı veya disk listesi alınamadı.</p>
        </div>
        {% endif %}
    </div>
{% endblock %}
