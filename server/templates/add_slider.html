{% extends 'base_admin.html' %}

{% block title %}Yeni Slider Ekle{% endblock %}

{% block content %}
    <div class="page-header">
        <h1 class="page-title">
            <i class="fas fa-plus-circle"></i>
            Yeni Slider Ekle
        </h1>
        <p class="page-description">Ana sayfa slider'ƒ±na yeni bir g√∂rsel ekleyin</p>
    </div>

    <form method="POST" enctype="multipart/form-data">
        <div class="card">
            <div class="card-header-modern">
                <h3>
                    <i class="fas fa-sliders-h"></i>
                    Slider Bilgileri
                </h3>
            </div>
            <div class="card-body-modern">
                <div class="form-grid-modern">
                    <!-- Oyun Se√ßimi -->
                    <div class="form-group-modern full-width">
                        <label class="form-label-modern">
                            <i class="fas fa-gamepad"></i>
                            <span>√ñne √áƒ±karƒ±lacak Oyun</span>
                        </label>
                        <div class="search-select-wrapper">
                            <input type="text" id="game_search_input" placeholder="Oyun adƒ±nƒ± yazarak ara..." autocomplete="off" class="form-input-modern">
                            <input type="hidden" name="game_id" id="game_id_hidden">
                            <div id="game_search_results" class="search-results-dropdown"></div>
                        </div>
                        <div class="input-hint">Slider'da √∂ne √ßƒ±karƒ±lacak oyunu se√ßin</div>
                    </div>

                    <!-- Rozet & Ba≈ülƒ±k -->
                    <div class="form-group-modern">
                        <label class="form-label-modern">
                            <i class="fas fa-tag"></i>
                            <span>Rozet</span>
                        </label>
                        <select name="badge_text" id="badge_text" class="form-input-modern">
                            <option value="üî• POP√úLER">üî• POP√úLER</option>
                            <option value="‚ú® YENƒ∞ OYUN">‚ú® YENƒ∞ OYUN</option>
                            <option value="‚≠ê √ñNE √áIKAN">‚≠ê √ñNE √áIKAN</option>
                            <option value="üéÆ √úCRETSƒ∞Z">üéÆ √úCRETSƒ∞Z</option>
                        </select>
                    </div>

                    <div class="form-group-modern">
                        <label class="form-label-modern">
                            <i class="fas fa-heading"></i>
                            <span>Ba≈ülƒ±k</span>
                        </label>
                        <input type="text" name="title" id="title" required class="form-input-modern" placeholder="Slider ba≈ülƒ±ƒüƒ±...">
                    </div>

                    <!-- A√ßƒ±klama -->
                    <div class="form-group-modern full-width">
                        <label class="form-label-modern">
                            <i class="fas fa-align-left"></i>
                            <span>A√ßƒ±klama</span>
                        </label>
                        <textarea name="description" id="description" rows="3" class="form-input-modern" placeholder="Slider a√ßƒ±klamasƒ±..."></textarea>
                    </div>

                    <!-- Arkaplan G√∂rseli -->
                    <div class="form-group-modern full-width">
                        <label class="form-label-modern">
                            <i class="fas fa-image"></i>
                            <span>Arkaplan G√∂rseli</span>
                        </label>
                        <div class="file-upload-zone" onclick="document.getElementById('background_image_input').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <div class="upload-text">
                                <h4>G√∂rsel y√ºklemek i√ßin tƒ±klayƒ±n</h4>
                                <p>√ñnerilen: 1920x1080px - JPG, PNG veya WebP</p>
                            </div>
                            <span class="file-name" id="background_image_name">Dosya se√ßilmedi</span>
                        </div>
                        <input type="file" name="background_image" id="background_image_input" class="hidden-input" accept="image/jpeg, image/png, image/webp" required>
                    </div>

                    <!-- G√∂sterim Sƒ±rasƒ± & Aktif -->
                    <div class="form-group-modern">
                        <label class="form-label-modern">
                            <i class="fas fa-sort-numeric-down"></i>
                            <span>G√∂sterim Sƒ±rasƒ±</span>
                        </label>
                        <input type="number" name="display_order" id="display_order" value="0" class="form-input-modern">
                    </div>

                    <div class="form-group-modern">
                        <label class="checkbox-label-modern">
                            <input type="checkbox" name="is_active" id="is_active" checked>
                            <span class="checkbox-text">
                                <i class="fas fa-eye"></i>
                                Slider Aktif
                            </span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
            <a href="{{ url_for('manage_sliders') }}" class="btn btn-secondary-modern">
                <i class="fas fa-arrow-left"></i> Geri D√∂n
            </a>
            <button type="submit" class="btn btn-primary-modern">
                <i class="fas fa-plus"></i> Slider Ekle
            </button>
        </div>
    </form>
{% endblock %}

{% block head %}
<style>
    /* Modern Form Grid */
    .form-grid-modern {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
    }

    .form-group-modern {
        display: flex;
        flex-direction: column;
    }

    .form-group-modern.full-width {
        grid-column: 1 / -1;
    }

    .form-label-modern {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.75rem;
        font-weight: 600;
        font-size: 0.9375rem;
        color: var(--foreground);
    }

    .form-label-modern i {
        color: #64748b;
        font-size: 1rem;
    }

    .form-input-modern {
        width: 100%;
        padding: 0.875rem 1rem;
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 0.5rem;
        color: var(--foreground);
        font-size: 0.9375rem;
        transition: all 0.3s;
        font-family: 'Poppins', sans-serif;
    }

    .form-input-modern:focus {
        outline: none;
        border-color: #64748b;
        background: rgba(0, 0, 0, 0.3);
        box-shadow: 0 0 0 3px rgba(100, 116, 139, 0.1);
    }

    .form-input-modern::placeholder {
        color: var(--muted-foreground);
        opacity: 0.6;
    }

    /* Search Select */
    .search-select-wrapper {
        position: relative;
    }

    .search-results-dropdown {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: rgba(0, 0, 0, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 0.5rem;
        margin-top: 0.5rem;
        max-height: 300px;
        overflow-y: auto;
        z-index: 1000;
        display: none;
        backdrop-filter: blur(10px);
    }

    .search-result-item {
        padding: 0.875rem 1rem;
        cursor: pointer;
        transition: all 0.2s;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .search-result-item:hover {
        background: rgba(100, 116, 139, 0.2);
    }

    .search-result-item.no-results {
        cursor: default;
        color: var(--muted-foreground);
        text-align: center;
    }

    .search-result-item.no-results:hover {
        background: transparent;
    }

    /* File Upload Zone */
    .file-upload-zone {
        border: 2px dashed rgba(255, 255, 255, 0.2);
        border-radius: 0.5rem;
        padding: 2rem;
        text-align: center;
        background: rgba(0, 0, 0, 0.1);
        transition: all 0.3s;
        cursor: pointer;
    }

    .file-upload-zone:hover {
        border-color: #64748b;
        background: rgba(100, 116, 139, 0.05);
    }

    .upload-icon {
        font-size: 3rem;
        color: #64748b;
        margin-bottom: 1rem;
    }

    .upload-text h4 {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--foreground);
        margin: 0 0 0.5rem 0;
    }

    .upload-text p {
        color: var(--muted-foreground);
        margin: 0 0 1rem 0;
        font-size: 0.875rem;
    }

    .file-name {
        display: inline-block;
        padding: 0.5rem 1rem;
        background: rgba(100, 116, 139, 0.2);
        border-radius: 0.375rem;
        font-size: 0.875rem;
        color: var(--muted-foreground);
    }

    .hidden-input {
        display: none;
    }

    /* Checkbox */
    .checkbox-label-modern {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        cursor: pointer;
        padding: 1rem;
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 0.5rem;
        transition: all 0.3s;
    }

    .checkbox-label-modern:hover {
        border-color: rgba(255, 255, 255, 0.2);
        background: rgba(0, 0, 0, 0.3);
    }

    .checkbox-label-modern input[type="checkbox"] {
        width: 1.25rem;
        height: 1.25rem;
        accent-color: #64748b;
    }

    .checkbox-text {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
        font-size: 0.9375rem;
        color: var(--foreground);
    }

    .checkbox-text i {
        color: #64748b;
    }

    /* Form Actions */
    .form-actions {
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
        margin-top: 2rem;
    }

    .btn-secondary-modern {
        padding: 0.875rem 1.5rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 0.5rem;
        color: var(--foreground);
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
        transition: all 0.3s;
    }

    .btn-secondary-modern:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-1px);
    }

    .btn-primary-modern {
        padding: 0.875rem 1.5rem;
        background: linear-gradient(135deg, #64748b 0%, #475569 100%);
        border: none;
        border-radius: 0.5rem;
        color: white;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
        font-size: 0.9375rem;
        font-family: 'Poppins', sans-serif;
        transition: all 0.3s;
    }

    .btn-primary-modern:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(100, 116, 139, 0.4);
    }

    .input-hint {
        font-size: 0.75rem;
        color: var(--muted-foreground);
        margin-top: 0.25rem;
        opacity: 0.7;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .form-grid-modern {
            grid-template-columns: 1fr;
        }

        .form-actions {
            flex-direction: column;
        }
    }
</style>
{% endblock %}

{% block scripts %}
    <script>
        const games = [
            {% for game in games %}
                { id: {{ game.id }}, name: {{ game.oyun_adi|tojson }} },
            {% endfor %}
        ];

        // Game search functionality
        const gameSearchInput = document.getElementById('game_search_input');
        const gameSearchResults = document.getElementById('game_search_results');
        const gameIdHidden = document.getElementById('game_id_hidden');

        gameSearchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            
            if (searchTerm.length === 0) {
                gameSearchResults.style.display = 'none';
                gameSearchResults.innerHTML = '';
                return;
            }

            const filteredGames = games.filter(game => 
                game.name.toLowerCase().includes(searchTerm)
            );

            if (filteredGames.length > 0) {
                gameSearchResults.innerHTML = filteredGames.map(game => 
                    `<div class="search-result-item" data-id="${game.id}" data-name="${game.name}">
                        ${game.name}
                    </div>`
                ).join('');
                gameSearchResults.style.display = 'block';
            } else {
                gameSearchResults.innerHTML = '<div class="search-result-item no-results">Oyun bulunamadƒ±</div>';
                gameSearchResults.style.display = 'block';
            }
        });

        // Handle result selection
        gameSearchResults.addEventListener('click', function(e) {
            const resultItem = e.target.closest('.search-result-item');
            if (resultItem && !resultItem.classList.contains('no-results')) {
                const gameId = resultItem.getAttribute('data-id');
                const gameName = resultItem.getAttribute('data-name');
                
                gameSearchInput.value = gameName;
                gameIdHidden.value = gameId;
                gameSearchResults.style.display = 'none';
                gameSearchResults.innerHTML = '';
            }
        });

        // Close search results when clicking outside
        document.addEventListener('click', function(e) {
            if (!gameSearchInput.contains(e.target) && !gameSearchResults.contains(e.target)) {
                gameSearchResults.style.display = 'none';
            }
        });

        // File input handling
        const backgroundImageInput = document.getElementById('background_image_input');
        const backgroundImageName = document.getElementById('background_image_name');

        if (backgroundImageInput) {
            backgroundImageInput.addEventListener('change', function() {
                if (this.files && this.files[0]) {
                    backgroundImageName.textContent = this.files[0].name;
                    backgroundImageName.style.color = 'var(--foreground)';
                } else {
                    backgroundImageName.textContent = 'Dosya se√ßilmedi';
                    backgroundImageName.style.color = 'var(--muted-foreground)';
                }
            });
        }
    </script>
{% endblock %}
